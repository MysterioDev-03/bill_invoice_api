# render.yaml
services:
  - type: web
    name: your-api-service # Change this to your desired service name
    env: python
    region: oregon # Use a region close to you
    plan: starter # Use 'starter' for the free-tier equivalent
    
    # -----------------------------------------------------------
    # The 'buildCommand' is the key to solving your 500 Error.
    # It installs system dependencies (Tesseract and Poppler)
    # before installing Python requirements.
    # -----------------------------------------------------------
    buildCommand: |
      # 1. Update package list and install Tesseract and Poppler libraries
      sudo apt-get update
      sudo apt-get install -y tesseract-ocr libtesseract-dev libpoppler-cpp-dev poppler-utils
      
      # 2. Install Python dependencies
      pip install -r requirements.txt
      
    # -----------------------------------------------------------
    # The 'startCommand' runs your Uvicorn server.
    # Ensure 'main:app' matches your entry point.
    # -----------------------------------------------------------
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT

    envVars:
      - key: PYTHON_VERSION
        value: 3.11.8 # Set a stable Python version, or omit to use default
      - key: WEB_CONCURRENCY
        value: 1 # Recommended for free/starter plans